@{ 
    if (Model == null)
    {
        return;
    }
    List<Sheet> list = Model as List<Sheet>;
    var dialy = list.Where(e => e.Type == SheetType.Daily).ToList();
    var errand = list.Where(e => e.Type == SheetType.Errand).ToList();
    var last = list.OrderBy(e => e.Money).FirstOrDefault();
    var first = list.OrderByDescending(e => e.Money).FirstOrDefault();
}

<div class="col-md-12">
    <h3 class="text-center">报销单详情</h3>
    <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#All" role="tab" data-toggle="tab">总览</a></li>
        <li role="presentation" class=""><a href="#Sheet" role="tab" data-toggle="tab">报销列表<span class="badge">@(list.Count)</span></a></li>
        <li role="presentation" class=""><a href="#Sheet-Daily" role="tab" data-toggle="tab">日常报销<span class="badge">@(dialy.Count)</span></a></li>
        <li role="presentation" class=""><a href="#Sheet-Errand" role="tab" data-toggle="tab">出差报销<span class="badge">@(errand.Count)</span></a></li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane active" role="tabpanel" id="All">
            <table class="table table-striped">
                <tbody>
                    <tr>
                        <th rowspan="2">本月成功报销：</th>
                        <td rowspan="2">@(list.Count)笔</td>
                        <th>日常报销：</th>
                        <td>@(dialy.Count)笔</td>
                    </tr>
                    <tr>
                        <th>出差报销：</th>
                        <td>@(errand.Count)笔</td>
                    </tr>
                    <tr>
                        <th>单笔报销金额最多[元]：</th>
                        <td><a href="/Report/Detail?id=@(first.ID)">@(string.Format("{0}报销了{1}元", first.Name, first.Money))</a></td>
                        <th>单笔报销金额最少[元]：</th>
                        <td><a href="/Report/Detail?id=@(last.ID)">@(string.Format("{0}报销了{1}元", last.Name, last.Money))</a></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tab-pane" role="tabpanel" id="Sheet">
            <table class="table table-striped table-condensed table-hover">
                <thead>
                    <tr>
                        <th>单据编号</th>
                        <th>填写日期</th>
                        <th>报销金额[元]</th>
                        <th>报销人</th>
                        <th>报销类别</th>
                        <th>备注</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach(var item in list.OrderBy(e=>e.CheckNumber))
                    {
                        <tr>
                            <td><a href="/Report/Detail?id=@(item.ID)">@(item.CheckNumber)</a> </td>
                            <td>@(item.Time.ToShortDateString())</td>
                            <td>@(item.Money)</td>
                            <td>@(item.Name)</td>
                            <td>
                                @if (item.Type == SheetType.Daily)
                                {
                                    <label class="label label-warning">@(item.Type.GetDescription())</label>
                                }
                                else
                                {
                                    <label class="label label-default">@(item.Type.GetDescription())</label>
                                }
                            </td>
                            <td>@(item.Remarks)</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        <div class="tab-pane" role="tabpanel" id="Sheet-Daily">
            <table class="table table-bordered table-condensed table-hover">
                <thead>
                    <tr>
                        <th rowspan="2">单据编号</th>
                        <th rowspan="2">报销金额[元]</th>
                        <th rowspan="2">报销人</th>
                        <th colspan="3" class="text-center">日常分项详情</th>
                    </tr>
                    <tr>
                        <th>类别</th>
                        <th>内容</th>
                        <th>金额[元]</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach(var item in dialy.OrderBy(e => e.CheckNumber))
                    {
                        var row = item.Substances != null && item.Substances.Count > 0 ? item.Substances.Count : 0;
                        row = row + 1;
                        <tr>
                            <td rowspan="@(row)"><a href="/Report/Detail?id=@(item.ID)">@(item.CheckNumber)</a></td>
                            <td rowspan="@(row)">@(item.Money)</td>
                            <td rowspan="@(row)">@(item.Name)</td>
                        </tr>
                        if (item.Substances != null && item.Substances.Count > 0)
                        {
                            foreach (var sub in item.Substances)
                            {
                                <tr>
                                    <td>@(sub.SecondCategory.HasValue ? sub.Category.GetDescription() + "-" + sub.SecondCategory.Value.GetDescription() : sub.Category.GetDescription())</td>
                                    <td>@(sub.Details)</td>
                                    <td>@(sub.Price)</td>
                                </tr>
                            }
                        }
                    }
                </tbody>
            </table>
        </div>
        <div class="tab-pane" role="tabpanel" id="Sheet-Errand">
            <table class="table table-bordered table-condensed table-hover">
                <thead>
                    <tr>
                        <th rowspan="2">单据编号</th>
                        <th rowspan="2">报销金额[元]</th>
                        <th rowspan="2">报销人</th>
                        <th colspan="7" class="text-center">出差详情</th>
                    </tr>
                    <tr>
                        <th>出差地点</th>
                        <th>事由/项目</th>
                        <th>出差人员</th>
                        <th>交通费用[元]</th>
                        <th>出差住宿</th>
                        <th>其他内容</th>
                        <th>其他金额[元]</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in errand.OrderBy(e => e.CheckNumber))
                    {
                        if (item.Evection != null)
                        {
                            <tr>
                                <td><a href="/Report/Detail?id=@(item.ID)">@(item.CheckNumber)</a></td>
                                <td>@(item.Money)</td>
                                <td>@(item.Name)</td>
                                <td>@(item.Evection.Place)</td>
                                <td>@(item.Evection.Reason)</td>
                                <td>@(item.Evection.Persons)</td>
                                <td>@(item.Evection.Traffic)</td>
                                <td>@(item.Evection.Hotel)</td>
                                <td>@(item.Evection.Mark)</td>
                                <td>@(item.Evection.Other)</td>
                            </tr>
                        }

                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

